<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Armotek Films</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{margin:0;font-family:Arial;background:#121212;color:#fff}
.header{padding:15px;text-align:center;background:#1e1e1e}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px}
.card{background:#1e1e1e;border-radius:8px;padding:10px}
.btn{background:#D4AF37;border:none;padding:10px;width:100%;margin-top:5px;font-weight:bold}
.view{display:none;padding-bottom:80px}
.view.active{display:block}
.bottom{position:fixed;bottom:0;width:100%;display:flex;background:#1e1e1e}
.bottom div{flex:1;text-align:center;padding:10px;cursor:pointer}
input,select{width:100%;padding:10px;margin-top:5px}
</style>
</head>

<body>
<div class="header"><b>ARMOTEK FILMS</b></div>

<div id="catalog" class="view active">
 <div class="grid" id="grid"></div>
</div>

<div id="cart" class="view">
 <div id="cartItems"></div>
 <b id="total"></b>
 <button class="btn" onclick="checkout()">ÐžÑ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ</button>
</div>

<div id="checkout" class="view">
 <input id="name" placeholder="Ð˜Ð¼Ñ">
 <input id="phone" placeholder="Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½">
 <input id="city" placeholder="Ð“Ð¾Ñ€Ð¾Ð´">
 <button class="btn" onclick="send()">ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·</button>
</div>

<div class="bottom">
 <div onclick="tab('catalog')">ðŸ“‚</div>
 <div onclick="tab('cart')">ðŸ›’</div>
</div>

<script>
const tg = Telegram.WebApp; tg.expand();

const products=[
 {id:1,name:"Ð190",price:45000},
 {id:2,name:"Ð190 (Ð¾Ñ‚Ñ€ÐµÐ·)",price:2500},
 {id:3,name:"Crystal Premium 215",price:52000},
 {id:4,name:"Crystal Matte",price:50000},
];

let cart = JSON.parse(localStorage.getItem("cart")||"[]");

function save(){localStorage.setItem("cart",JSON.stringify(cart));}

function render(){
 const g=document.getElementById("grid"); g.innerHTML="";
 products.forEach(p=>{
  g.innerHTML+=`<div class=card>
   <b>${p.name}</b><br>${p.price} â‚½
   <button class=btn onclick="add(${p.id})">Ð’ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ</button>
  </div>`;
 });
}

function add(id){
 let p=products.find(x=>x.id===id);
 let c=cart.find(x=>x.id===id);
 c?c.qty++:cart.push({...p,qty:1});
 save(); alert("Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾");
}

function showCart(){
 let c=document.getElementById("cartItems"); c.innerHTML="";
 let sum=0;
 cart.forEach((i,n)=>{
  sum+=i.price*i.qty;
  c.innerHTML+=`${i.name} x${i.qty}<br>`;
 });
 document.getElementById("total").innerText="Ð¡ÑƒÐ¼Ð¼Ð°: "+sum+" â‚½";
}

function checkout(){
 if(!cart.length) return alert("ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð° Ð¿ÑƒÑÑ‚Ð°");
 tab('checkout');
}

function send(){
 let data={
  cart:cart,
  customer:{
   name:document.getElementById("name").value,
   phone:document.getElementById("phone").value,
   city:document.getElementById("city").value
  },
  total:cart.reduce((s,i)=>s+i.price*i.qty,0)
 };
 tg.sendData(JSON.stringify(data));
 localStorage.removeItem("cart");
}

function tab(id){
 document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 if(id==="cart") showCart();
}

render();
</script>
</body>
</html>
